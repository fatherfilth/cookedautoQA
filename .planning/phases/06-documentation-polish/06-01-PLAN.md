---
phase: 06-documentation-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
  - docs/RUNBOOK.md
autonomous: true
must_haves:
  truths:
    - "Developer can clone repo, follow README, and run tests locally within 10 minutes"
    - "Developer knows how to set env vars by reading README and .env.example"
    - "Developer can add a new test by following the Adding New Tests section"
    - "Developer can debug flaky tests using the Troubleshooting section"
    - "On-call engineer can triage a Slack alert using RUNBOOK.md checklist within 5 minutes"
    - "On-call engineer can distinguish real failures from false positives using RUNBOOK.md"
    - "On-call engineer knows when and how to escalate using the escalation paths"
  artifacts:
    - path: "README.md"
      provides: "Developer onboarding, local setup, test authoring, troubleshooting"
      contains: "## Running Tests"
    - path: "docs/RUNBOOK.md"
      provides: "Alert triage checklist, escalation paths, false positives"
      contains: "## Triage Checklist"
  key_links:
    - from: "README.md"
      to: "docs/SELECTOR-STRATEGY.md"
      via: "markdown link"
      pattern: "SELECTOR-STRATEGY\\.md"
    - from: "README.md"
      to: "docs/RUNBOOK.md"
      via: "markdown link"
      pattern: "RUNBOOK\\.md"
    - from: "README.md"
      to: ".env.example"
      via: "markdown link"
      pattern: "\\.env\\.example"
    - from: "docs/RUNBOOK.md"
      to: ".github/workflows/playwright.yml"
      via: "reference"
      pattern: "playwright\\.yml"
---

<objective>
Create developer onboarding README and operations alert triage runbook for the COOKEDQA synthetic monitoring project.

Purpose: Complete the final phase by providing team-facing documentation that enables developers to run tests locally, add new tests, and troubleshoot flakiness (README.md), and operations staff to triage Slack alerts quickly with clear escalation paths (docs/RUNBOOK.md).

Output: README.md at project root, docs/RUNBOOK.md for alert triage
</objective>

<execution_context>
@C:/Users/Karl/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Karl/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Existing files to reference (don't duplicate, link to them)
@.env.example
@package.json
@playwright.config.ts
@docs/SELECTOR-STRATEGY.md
@.github/workflows/playwright.yml
@scripts/notify-slack.js

# Research templates
@.planning/phases/06-documentation-polish/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create README.md for developer onboarding</name>
  <files>README.md</files>
  <action>
Create README.md at project root covering DOCS-01 requirements. Use the actual project structure and configuration (not generic templates). The README must be grounded in the real files that exist in this repo.

**Sections to include (in order):**

1. **Title and Overview** — "COOKEDQA - Synthetic Monitoring for cooked.com". 2-3 sentences: automated E2E tests monitoring critical user flows (auth, games, chat, crypto) on a 30-min cron via GitHub Actions with Slack alerts.

2. **Prerequisites** — Node.js 20+, npm 10+, Git. List exact versions from package.json (packageManager: npm@10.9.2).

3. **Installation** — Copy-pasteable commands: git clone, npm install, npx playwright install chromium. Note Chromium-only (no other browsers needed).

4. **Configuration** — Reference .env.example (link to it). List the env vars in a table with columns: Variable, Required?, Default, Description. Pull the actual variables from the existing .env.example file:
   - BASE_URL (required, default https://cooked.com)
   - TEST_USER_EMAIL (required, no default, "get from team lead")
   - TEST_USER_PASSWORD (required, no default, "get from team lead")
   - SLACK_WEBHOOK_URL (optional, for local alert testing)
   - HEADLESS (optional, default true)
   - GAME_SLOT_ID, GAME_SLOT_NAME, etc. (optional, have defaults)
   - CRYPTO_BUY_PATH, CRYPTO_IFRAME_SRC (optional, have defaults)

5. **Running Tests** — Show all npm scripts from package.json:
   - `npm test` (all tests)
   - `npm run test:critical` (@critical only)
   - `npm run test:warning` (@warning only)
   - `npm run test:headed` (see browser)
   - `npm run test:debug` (Playwright Inspector)
   Also mention: `npx playwright test tests/auth/login.spec.ts` for running a single test file.

6. **Project Structure** — Show the actual directory tree with brief descriptions:
   ```
   tests/
   ├── auth/           # Login, registration, session persistence (3 tests)
   ├── smoke/          # Homepage, navigation, lobby, search (5 tests)
   ├── game/           # Slot, table, live dealer launch (3 tests)
   ├── social/         # Chat, tipping, promotions (4 tests)
   ├── crypto/         # Swapped.com buy flow (2 tests)
   ├── pages/          # Page Object Model classes
   └── helpers/        # Config, retry, waits utilities
   scripts/
   └── notify-slack.js # Slack alerting with severity + consecutive failure tracking
   docs/
   ├── SELECTOR-STRATEGY.md  # Selector priority and patterns
   └── RUNBOOK.md            # Alert triage guide
   ```

7. **Adding New Tests** — Step-by-step:
   1. Create file in `tests/<category>/<name>.spec.ts`
   2. Import from `@playwright/test` and page objects from `../pages/`
   3. Follow selector strategy (link to docs/SELECTOR-STRATEGY.md)
   4. Add severity tag in test title: `@critical` or `@warning`
   5. Show a minimal example test using an existing page object import pattern
   6. Mention the stop-before-payment pattern for any flow involving transactions

8. **Troubleshooting Flaky Tests** — Three subsections:
   - "Tests pass locally but fail in CI": check traces (download artifact, `npx playwright show-trace`), CI uses 2 retries vs 1 locally, CI is slower so avoid `waitForTimeout()`
   - "Element not found errors": use Playwright Inspector (`npm run test:debug`), check auto-waiting, review selector strategy
   - "Network/timeout failures": check BASE_URL env var, use `retryAction()` from `tests/helpers/retry.ts`, increase timeout in `playwright.config.ts`

9. **CI/CD** — Brief section: tests run every 30 min on GitHub Actions, also on push to main and manual dispatch. Link to workflow file. Mention artifacts: playwright-report (30-day retention) and test-results with traces/screenshots (7-day retention). Link to docs/RUNBOOK.md for alert triage.

10. **Selector Strategy** — Quick reference (4-5 lines) with link to docs/SELECTOR-STRATEGY.md for full details. Don't duplicate the full doc.

**Style guidelines:**
- Use copy-pasteable bash commands in fenced code blocks
- Keep prose minimal; prefer tables, lists, and code blocks
- Link to actual project files (relative paths) rather than duplicating content
- Do NOT include placeholder URLs like "your-org" — use relative paths for in-repo links
  </action>
  <verify>
Verify README.md exists at project root. Check that it contains all required sections: Prerequisites, Installation, Configuration, Running Tests, Adding New Tests, Troubleshooting, CI/CD. Verify it links to docs/SELECTOR-STRATEGY.md, docs/RUNBOOK.md, and .env.example. Verify all npm script names match package.json exactly.
  </verify>
  <done>README.md exists at project root with all DOCS-01 sections. Every npm script name matches package.json. All env vars from .env.example are documented. Links to SELECTOR-STRATEGY.md, RUNBOOK.md, and .env.example are present.</done>
</task>

<task type="auto">
  <name>Task 2: Create docs/RUNBOOK.md for alert triage</name>
  <files>docs/RUNBOOK.md</files>
  <action>
Create docs/RUNBOOK.md covering DOCS-02 requirements. This is an operations-facing document for responding to Slack alerts from the playwright-monitoring workflow.

**Sections to include (in order):**

1. **Title** — "Alert Triage Runbook"

2. **When to Use This Runbook** — Trigger: Slack alert received from `Playwright Monitoring` GitHub Actions workflow. The alert fires after 2+ consecutive failures (ALERT_THRESHOLD = 2). Reference the Slack channel where alerts appear.

3. **Alert Anatomy** — What the Slack message contains: severity level (CRITICAL or WARNING), list of failed test names with consecutive failure counts, error snippets, links to GitHub Actions run and artifacts. Reference scripts/notify-slack.js as the source.

4. **Severity Levels** — Table with columns: Tag, Meaning, Test Categories, Response Time, Escalation.
   - `@critical`: Revenue-impacting flows (auth: login/registration/session, games: slot/table/live dealer launch, crypto: Swapped.com buy flow). Investigate immediately.
   - `@warning`: Non-critical features (smoke: homepage/navigation/lobby/search, social: chat/tipping/promotions). Investigate within 4 hours.

5. **Triage Checklist** — Numbered checklist with checkboxes:
   - [ ] Step 1: Click GitHub Actions run link from Slack alert
   - [ ] Step 2: Check if multiple tests failed (site-wide issue) or single test (isolated)
   - [ ] Step 3: Download `playwright-report` artifact, open with `npx playwright show-report <folder>`
   - [ ] Step 4: For each failed test, view screenshot and trace in the report
   - [ ] Step 5: Determine root cause (site issue vs test issue vs flaky test)
   - [ ] Step 6: Take action based on root cause (see below)

6. **Root Cause Decision Table** — Table with columns: Symptom, Likely Cause, Action.
   - Multiple unrelated tests fail → Site down/slow → Check cooked.com manually, escalate
   - Single test fails consistently → Feature changed or test broken → Create GitHub issue
   - Login/auth tests fail → Credentials expired or auth down → Verify test user account
   - Game launch tests fail → Provider iframe timeout → Check game manually, may be provider outage
   - Chat/social tests fail → Chat service degraded → Check manually, likely non-critical
   - Test fails once then passes on retry → Flaky test → Monitor, create issue if recurring

7. **Common False Positives** — Document 3-4 known patterns with structure for each: Symptom, Why it's a false positive, How to recognize, Action. Based on actual test files:
   - WebSocket connection timeout in chat tests (off-peak hours, resolves on retry)
   - Game iframe load timeout (third-party provider slowness, not cooked.com issue)
   - Session persistence flake (cookie timing race condition)
   - Network timeout on first test of suite (cold start, subsequent tests pass)

8. **Escalation Paths** — Table with columns: Scenario, Notify, Channel, Urgency.
   - Multiple @critical tests fail → On-call engineer → #incidents → Immediate
   - Single @critical test fails 3+ times → Dev team lead → #dev-team → 1 hour
   - @warning tests fail → QA team → #qa-alerts → 4 hours
   - Tests pass after retry → No one → N/A → No action
   - Unknown failure pattern → Test automation lead → #test-automation → Next business day

9. **Quick Actions** — Copy-pasteable commands:
   - Re-run failed test locally with trace: `npx playwright test <test-file> --trace on`
   - View trace: `npx playwright show-trace test-results/<test-name>/trace.zip`
   - View HTML report from CI: download artifact, extract, `npx playwright show-report <folder>`
   - Check consecutive failure state: `cat .state/failure-state.json`
   - Manually trigger workflow: `gh workflow run playwright.yml` (requires gh CLI)

10. **Contacts** — Placeholder section with roles: Dev Team Lead, QA Lead, On-Call rotation link. Use placeholder format `@role-name (Slack)` so team can fill in real names.

11. **Runbook Maintenance** — Last updated date, review schedule (after incidents + quarterly), owner (Test Automation Team).

**Style guidelines:**
- Checklists and tables over prose paragraphs — this is read during incidents
- Every action should be copy-pasteable or a clear decision (do X or Y)
- Reference actual file paths in the project (scripts/notify-slack.js, .github/workflows/playwright.yml)
- Keep false positive entries specific to actual test files in this project
  </action>
  <verify>
Verify docs/RUNBOOK.md exists. Check that it contains: Triage Checklist section with checkboxes, Severity Levels table, Common False Positives section, Escalation Paths table, Quick Actions with bash commands. Verify it references actual project files (scripts/notify-slack.js, .github/workflows/playwright.yml).
  </verify>
  <done>docs/RUNBOOK.md exists with all DOCS-02 sections. Triage checklist has actionable checkboxes. Severity levels documented with response times. At least 3 common false positives documented. Escalation paths table present with clear urgency levels. Quick actions have copy-pasteable commands.</done>
</task>

</tasks>

<verification>
1. README.md exists at project root and is non-empty
2. docs/RUNBOOK.md exists and is non-empty
3. docs/SELECTOR-STRATEGY.md still exists (not modified or deleted)
4. README.md links to: docs/SELECTOR-STRATEGY.md, docs/RUNBOOK.md, .env.example
5. README.md documents all npm scripts from package.json (test, test:critical, test:warning, test:headed, test:debug)
6. README.md documents all env vars from .env.example
7. RUNBOOK.md has a triage checklist with checkbox items
8. RUNBOOK.md has severity levels matching project tags (@critical, @warning)
9. RUNBOOK.md has escalation paths table
10. RUNBOOK.md has common false positives section
</verification>

<success_criteria>
- A developer cloning the repo can follow README.md to install, configure, and run tests without asking questions
- A developer can use the Adding New Tests section to create a properly structured test file with correct imports and severity tag
- A developer experiencing flaky tests can find debugging steps in the Troubleshooting section
- An on-call engineer receiving a Slack alert can follow RUNBOOK.md to triage within 5 minutes
- The runbook clearly distinguishes @critical (immediate) from @warning (4-hour) response expectations
- Selector strategy documentation is referenced from README.md, not duplicated
</success_criteria>

<output>
After completion, create `.planning/phases/06-documentation-polish/06-01-SUMMARY.md`
</output>
